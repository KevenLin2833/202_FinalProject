---
title: "Covid-19 and its Impact on Students' Physical and Mental Health"
Name: Keven Lin & Adam Banwell
output:
  html_document:
    df_print: paged
---

```{r}
library(readxl)
library(ggplot2)
library(dplyr)
library(tidyr)
```

```{r}
data = read.csv("data.csv")
data
#sum(is.na(data[,'Rating.of.Online.Class.experience']))
```

```{r}
cleanData = data %>% drop_na('Rating.of.Online.Class.experience')
cleanData
#sum(is.na(cleanData[,'Rating.of.Online.Class.experience']))
sum(is.na(cleanData[,'Age.of.Subject']))
```

#age vs rating
```{r}
ggplot(cleanData, aes(x=Age.of.Subject, y=sum(Age.of.Subject)))+geom_bar(stat='identity')+facet_wrap(~Rating.of.Online.Class.experience, scales = "free")

cleanData %>% group_by(Age.of.Subject) %>% summarise()
```


### Rating of Online Class Experience vs Time Spent on Online Class
```{r}
temp = cleanData %>% group_by(Rating.of.Online.Class.experience) %>% summarise(avg_Time_Spent_On_Online_Class= sprintf(mean(Time.spent.on.Online.Class), fmt = '%.3f'))
temp 
temp %>% ggplot(aes(x=Rating.of.Online.Class.experience, y=avg_Time_Spent_On_Online_Class)) + 
  geom_bar(stat='identity') + geom_text(aes(label = avg_Time_Spent_On_Online_Class)) + ggtitle('Rating of Online Class Experience vs Time Spent on Online Class')
```
Here we can see that students that have a better experience with online classes tend to spend more time on online classes. While students who had a poor experience in online class would spend lessor time in online classes. 

# ---
#class hours vs rating

```{r}
#class hours vs rating
ggplot(cleanData, aes(x=Time.spent.on.Online.Class, y=sum(Time.spent.on.Online.Class)))+geom_bar(stat='identity')+facet_wrap(~Rating.of.Online.Class.experience, scales = "free")
```

# ---
# Change in Weight vs Time Spent on Online class
```{r}

tempNone = cleanData %>% filter(Time.spent.on.Online.Class %in% c(0)) %>% count(Change.in.your.weight)
tempNone %>% ggplot(mapping = aes(x=Change.in.your.weight, y=n, fill = Change.in.your.weight)) + geom_col() + geom_text(aes(label = n)) + ggtitle('Class Attendance: None vs Weight Change')

tempAverage = cleanData %>% filter(Time.spent.on.Online.Class %in% 1:3 ) %>% count(Change.in.your.weight)
tempAverage %>% ggplot(mapping = aes(x=Change.in.your.weight, y=n, fill = Change.in.your.weight)) + geom_col() + geom_text(aes(label = n)) + ggtitle('Class Attendance: Average vs Weight Change')

tempAboveAverage = cleanData %>% filter(Time.spent.on.Online.Class %in% 4:10) %>% count(Change.in.your.weight)
tempAboveAverage %>% ggplot(mapping = aes(x=Change.in.your.weight, y=n, fill = Change.in.your.weight)) + geom_col() + geom_text(aes(label = n)) + ggtitle('Class Attendance: Above Average vs Weight Change')



```

There is slight correlcation in weight change and average time spent on online class.

# ---
# Fitness Level vs health issues
```{r}
cleanData
cleanData = cleanData %>% mutate(FitnessActivity =  ifelse(Time.spent.on.fitness < 1, 'non-active', 'active'))
temp = cleanData %>% count(Health.issue.during.lockdown, FitnessActivity)
tempActive = temp %>% filter(FitnessActivity %in% c('active')) 
tempNonActive = temp %>% filter(FitnessActivity %in% c('non-active'))

tempActive %>% ggplot(aes(x='', y=n, fill=Health.issue.during.lockdown)) + geom_bar(width = 1, stat='identity')+ coord_polar("y", start=0) + ggtitle("Active Students vs Health Issues")

tempNonActive %>% ggplot(aes(x='', y=n, fill=Health.issue.during.lockdown)) + geom_bar(width = 1, stat='identity')+ coord_polar("y", start=0) + ggtitle("Non-Active Students vs Health Issues")

```

#  ---
# Fitness Level vs Weight Gain
```{r}
temp =cleanData %>% count(FitnessActivity, Change.in.your.weight)
tempActive = temp %>% filter(FitnessActivity %in% c('active')) 
tempNonActive = temp %>% filter(FitnessActivity %in% c('non-active'))
tempActive

tempActive %>% ggplot(aes(x='', y=n, fill=Change.in.your.weight)) + geom_bar(width = 1, stat='identity')+ coord_polar("y", start=0) + ggtitle("Active Students vs Weight Change")

tempNonActive %>% ggplot(aes(x='', y=n, fill=Change.in.your.weight)) + geom_bar(width = 1, stat='identity')+ coord_polar("y", start=0) + ggtitle("Non-Active Students vs Weight Change")
```
# ---
# Health Issues vs Time spent on Social Media 
```{r}
cleanData = cleanData %>% mutate(SocialMediaActivity =  ifelse(Time.spent.on.social.media <= 1, 'non-active', 'active'))

temp =cleanData %>% count(Health.issue.during.lockdown, SocialMediaActivity)
tempActive = temp %>% filter(SocialMediaActivity %in% c('active')) 
tempNonActive = temp %>% filter(SocialMediaActivity %in% c('non-active'))

tempActive %>% ggplot(aes(x='', y=n, fill=Health.issue.during.lockdown)) + geom_bar(width = 1, stat='identity')+ coord_polar("y", start=0) + ggtitle("Social Media: Active Students vs Health Issues")

tempNonActive %>% ggplot(aes(x='', y=n, fill=Health.issue.during.lockdown)) + geom_bar(width = 1, stat='identity')+ coord_polar("y", start=0) + ggtitle("Social Media: Non-Active Students vs Health Issues")
```
# --- 
# Social Media vs Weight Gain
```{r}
temp =cleanData %>% count(SocialMediaActivity, Change.in.your.weight)
tempActive = temp %>% filter(SocialMediaActivity %in% c('active')) 
tempNonActive = temp %>% filter(SocialMediaActivity %in% c('non-active'))

tempActive %>% ggplot(aes(x='', y=n, fill=Change.in.your.weight)) + geom_bar(width = 1, stat='identity')+ coord_polar("y", start=0) + ggtitle("Social Media: Active Students vs Weight Changes")

tempNonActive %>% ggplot(aes(x='', y=n, fill=Change.in.your.weight)) + geom_bar(width = 1, stat='identity')+ coord_polar("y", start=0) + ggtitle("Social Media: Non-Active Students vs Weight Changes")
```
# ---
# Fitness Level vs Online Class Rating
```{r}
temp =cleanData %>% count(FitnessActivity, Rating.of.Online.Class.experience)
tempActive = temp %>% filter(FitnessActivity %in% c('active')) 
tempNonActive = temp %>% filter(FitnessActivity %in% c('non-active'))

tempActive %>% ggplot(aes(x='', y=n, fill=Rating.of.Online.Class.experience)) + geom_bar(width = 1, stat='identity')+ coord_polar("y", start=0) + ggtitle("Fitness Level: Active Students vs Online Class Rating")

tempNonActive %>% ggplot(aes(x='', y=n, fill=Rating.of.Online.Class.experience)) + geom_bar(width = 1, stat='identity')+ coord_polar("y", start=0) + ggtitle("Fitness Level: Non-Active Students vs Online Class Rating")
```

```{r}
cleanData
cleanData %>% filter(Health.issue.during.lockdown %in% c('NO')) %>% count(Age.of.Subject, Health.issue.during.lockdown) %>% arrange(-n)
cleanData %>% filter(Health.issue.during.lockdown %in% c('YES')) %>% count(Age.of.Subject, Health.issue.during.lockdown) %>% arrange(-n)
```

```{r}
temp = cleanData %>% count(Change.in.your.weight, Rating.of.Online.Class.experience) 

temp %>% filter(Change.in.your.weight %in% c('Decreased')) %>% ggplot(aes(x='', y=n, fill=Rating.of.Online.Class.experience)) + geom_bar(width = 1, stat='identity')+ coord_polar("y", start=0) + ggtitle("Weight Change: Decreased vs Online Class Rating")


temp %>% filter(Change.in.your.weight %in% c('Increased')) %>% ggplot(aes(x='', y=n, fill=Rating.of.Online.Class.experience)) + geom_bar(width = 1, stat='identity')+ coord_polar("y", start=0) + ggtitle("Weight Change: Increased vs Online Class Rating")

temp %>% filter(Change.in.your.weight %in% c('Remain Constant')) %>% ggplot(aes(x='', y=n, fill=Rating.of.Online.Class.experience)) + geom_bar(width = 1, stat='identity')+ coord_polar("y", start=0) + ggtitle("Weight Change: Remain Constant vs Online Class Rating")
```

```{r}
#age vs rating
ggplot(cleanData, aes(x=Age.of.Subject, y=sum(Age.of.Subject)))+geom_bar(stat='identity')+facet_wrap(~Rating.of.Online.Class.experience, scales = "free")

#Very poor has highest count(teens/20s), excellent highest count for under teens and lowest for teens-20s)

#class hours vs rating
ggplot(cleanData, aes(x=Time.spent.on.Online.Class, y=sum(Time.spent.on.Online.Class)))+geom_bar(stat='identity')+facet_wrap(~Rating.of.Online.Class.experience, scales = "free")

#rating vs health
ggplot(cleanData, aes(x=Rating.of.Online.Class.experience, y=Rating.of.Online.Class.experience, fill =Rating.of.Online.Class.experience))+geom_bar(stat='identity')+facet_wrap(~Health.issue.during.lockdown, scales = "free")+ theme(axis.text.y=element_blank())

#Time.utilized vs health
ggplot(cleanData, aes(x=Time.utilized, y=Time.utilized, fill =Time.utilized))+geom_bar(stat='identity')+facet_wrap(~Health.issue.during.lockdown, scales = "free")+ theme(axis.text.y=element_blank())

#Time vs 
yes = cleanData %>% filter(Health.issue.during.lockdown == "YES")
no = cleanData %>% filter(Health.issue.during.lockdown == "NO")

Excellent = cleanData %>% filter(Rating.of.Online.Class.experience == "Excellent")
Good = cleanData %>% filter(Rating.of.Online.Class.experience == "Good")
Average = cleanData %>% filter(Rating.of.Online.Class.experience == "Average")
Poor = cleanData %>% filter(Rating.of.Online.Class.experience == "Poor")
VeryPoor = cleanData %>% filter(Rating.of.Online.Class.experience == "Very poor")

temp <- data.frame(
  group=c("Online Class","Study","Fitness","Sleep","Social Media","TV"),
  value=c(mean(yes$Time.spent.on.Online.Class),
          mean(yes$Time.spent.on.self.study),
          mean(yes$Time.spent.on.fitness),
          mean(yes$Time.spent.on.sleep),
          mean(yes$Time.spent.on.social.media),
          mean(yes$Time.spent.on.TV))
)

temp2 <- data.frame(
  group=c("Online Class","Study","Fitness","Sleep","Social Media","TV"),
  value=c(mean(no$Time.spent.on.Online.Class),
          mean(no$Time.spent.on.self.study),
          mean(no$Time.spent.on.fitness),
          mean(no$Time.spent.on.sleep),
          mean(no$Time.spent.on.social.media),
          mean(no$Time.spent.on.TV))
)
temp3 <- data.frame(
  group=c("Online Class","Study","Fitness","Sleep","Social Media","TV"),
  value=c(mean(Excellent$Time.spent.on.Online.Class),
          mean(Excellent$Time.spent.on.self.study),
          mean(Excellent$Time.spent.on.fitness),
          mean(Excellent$Time.spent.on.sleep),
          mean(Excellent$Time.spent.on.social.media),
          mean(Excellent$Time.spent.on.TV))
)

temp4 <- data.frame(
  group=c("Online Class","Study","Fitness","Sleep","Social Media","TV"),
  value=c(mean(Good$Time.spent.on.Online.Class),
          mean(Good$Time.spent.on.self.study),
          mean(Good$Time.spent.on.fitness),
          mean(Good$Time.spent.on.sleep),
          mean(Good$Time.spent.on.social.media),
          mean(Good$Time.spent.on.TV))
)
temp5 <- data.frame(
  group=c("Online Class","Study","Fitness","Sleep","Social Media","TV"),
  value=c(mean(Average$Time.spent.on.Online.Class),
          mean(Average$Time.spent.on.self.study),
          mean(Average$Time.spent.on.fitness),
          mean(Average$Time.spent.on.sleep),
          mean(Average$Time.spent.on.social.media),
          mean(Average$Time.spent.on.TV))
)

temp6 <- data.frame(
  group=c("Online Class","Study","Fitness","Sleep","Social Media","TV"),
  value=c(mean(Poor$Time.spent.on.Online.Class),
          mean(Poor$Time.spent.on.self.study),
          mean(Poor$Time.spent.on.fitness),
          mean(Poor$Time.spent.on.sleep),
          mean(Poor$Time.spent.on.social.media),
          mean(Poor$Time.spent.on.TV))
)
temp7 <- data.frame(
  group=c("Online Class","Study","Fitness","Sleep","Social Media","TV"),
  value=c(mean(VeryPoor$Time.spent.on.Online.Class),
          mean(VeryPoor$Time.spent.on.self.study),
          mean(VeryPoor$Time.spent.on.fitness),
          mean(VeryPoor$Time.spent.on.sleep),
          mean(VeryPoor$Time.spent.on.social.media),
          mean(VeryPoor$Time.spent.on.TV))
)

#time vs health issue
ggplot(temp, aes(x="", y=value, fill=group))+geom_bar(stat='identity')+coord_polar("y", start=0)
ggplot(temp2, aes(x="", y=value, fill=group))+geom_bar(stat='identity')+coord_polar("y", start=0)

#time vs ratings
ggplot(temp3, aes(x="", y=value, fill=group))+geom_bar(stat='identity')+coord_polar("y", start=0)
ggplot(temp4, aes(x="", y=value, fill=group))+geom_bar(stat='identity')+coord_polar("y", start=0)
ggplot(temp5, aes(x="", y=value, fill=group))+geom_bar(stat='identity')+coord_polar("y", start=0)
ggplot(temp6, aes(x="", y=value, fill=group))+geom_bar(stat='identity')+coord_polar("y", start=0)
ggplot(temp7, aes(x="", y=value, fill=group))+geom_bar(stat='identity')+coord_polar("y", start=0)


```